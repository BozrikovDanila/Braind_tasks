Все символы кодирования записаны в словарь $dict.
Суть работы программы предствлена в функции decode_str, которая принимает три аргумента:
- зашифровываемая или зашифрованная строка $input 
- кодовое слово или просто строка, учавствовавшая в шифровании $code
- словарь символов $dict

'''
    function decode_str($input, $code, $dict)
    {
        $str1 = ''; // расшифрованный текст
    
        for ($i = 0, $j = 0; $i < mb_strlen($input); $i++, $j++) {
            $input_symb = $dict[mb_substr($input, $i, 1, 'UTF-8')];
            $code_symb = $dict[mb_substr($code, $j, 1, 'UTF-8')];
            $decode_symb = $input_symb ^ $code_symb; // XOR
    
            //$str1 .= array_search($decode_symb, $dict); // ВАРИАНТ №1 через функцию поиска ключа по значению
    
            // ВАРИАНТ №2 через UTF-8 character table
            // когда символ имеет код больше 9 (код соответствует словарю $dict), то дельта будет 1040, так как в $dict нет "Й", а в utf8-character-table есть
            // код 124 в таблице utf8 == "|";   "|"(0 согласно $dict) + 124 = 124
            $delta = $decode_symb == 0 ? 124 : ($decode_symb > 9 ? 1040 : 1039);
            $str1 .= mb_chr($decode_symb + $delta, 'UTF-8'); // конкатенируем символ в аккумулирующую строку
    
            if ($j == mb_strlen($code) - 1) $j = -1; // дошёл до последнего символа строки, перед инкрементацией ставим $j = -1 => в начале цикла $j будет равна 0
        }
    
        return $str1;
    }
'''

Из-за особенности шифрования (XOR шифр), не имеет значения в какой из аргументов будет передана зашифрованная строка, зашифровываемая строка или кодовое слово.
Имея два аргумента из операции можно с легкостью получить третий.
